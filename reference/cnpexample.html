<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Example of a boundary positions table. — cnpexample • CNprep</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Example of a boundary positions table. — cnpexample" />
<meta property="og:description" content="A table of genomic positions for DNA copy-number changing 
events, collected from genomes of 1203 individuals using Representational 
Oligonucleotide Microarray Analysis (ROMA) platform." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CNprep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CNprep.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/KrasnitzLab/CNprep/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Example of a boundary positions table.</h1>
    <small class="dont-index">Source: <a href='https://github.com/KrasnitzLab/CNprep/blob/master/R/CNprep.R'><code>R/CNprep.R</code></a></small>
    <div class="hidden name"><code>cnpexample.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A table of genomic positions for DNA copy-number changing 
events, collected from genomes of 1203 individuals using Representational 
Oligonucleotide Microarray Analysis (ROMA) platform.</p>
    </div>

    <pre class="usage"><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>cnpexample</span><span class='op'>)</span></pre>


    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p>a <code>data.frame</code> with 19188 rows and 4 columns:</p><dl>
<dt><code>copy.num</code></dt><dd><p>a <code>character</code> <code>vector</code> indicating 
    whether an event is a gain ("amp") or a loss ("del").</p></dd>
<dt><code>chrom</code></dt><dd><p>a <code>numeric</code> <code>vector</code> used as an integer 
    indicating which chromosome the event is in.</p></dd>
<dt><code>chrom.start</code></dt><dd><p>a <code>numeric</code> <code>vector</code>, used as an 
    integer, representing the event start positions.</p></dd>
<dt><code>chrom.end</code></dt><dd><p>a <code>numeric</code> <code>vector</code>, used as an integer,
    of event start positions.</p></dd>

</dl>

    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>Strong association of de novo copy number mutations with autism.
Sebat J, Lakshmi B, Malhotra D, Troge J, Lese-Martin C, Walsh T, Yamrom B, 
Yoon S, Krasnitz A, Kendall J, Leotta A, Pai D, Zhang R, Lee YH, Hicks J, 
Bregman J, Sutcliffe JS, Jobanputra V, Chung W, Warburton D, King MC, 
Skuse D, Geschwind DH, Gilliam TC, Ye K, Wigler M. 
Science. 2007 Apr 20;316(5823):445-9.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code>data.frame</code> with 19188 rows and 4 columns:</p><dl>
<dt><code>copy.num</code></dt><dd><p>a <code>character</code> <code>vector</code> indicating 
    whether an event is a gain ("amp") or a loss ("del").</p></dd>
<dt><code>chrom</code></dt><dd><p>a <code>numeric</code> <code>vector</code> used as an integer 
    indicating which chromosome the event is in.</p></dd>
<dt><code>chrom.start</code></dt><dd><p>a <code>numeric</code> <code>vector</code>, used as an 
    integer, representing the event start positions.</p></dd>
<dt><code>chrom.end</code></dt><dd><p>a <code>numeric</code> <code>vector</code>, used as an integer,
    of event start positions.</p></dd>

</dl>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'>
<ul>
<li><p><code><a href='CNpreprocessing.html'>CNpreprocessing</a></code>  for pre-processing DNA copy number 
(CN) data for detection of CN events.</p></li>
<li><p><code><a href='makeCNPmask.html'>makeCNPmask</a></code>  for creating a mask given a set of
copy number events.</p></li>
<li><p><code><a href='applyCNPmask.html'>applyCNPmask</a></code> for applying a mask to a table of 
copy number events.</p></li>
</ul>
</div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Load datasets</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>segexample</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>ratexample</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>normsegs</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>cnpexample</span><span class='op'>)</span>

<span class='co'>## Create a table with segment information for profile WZ2 with help</span>
<span class='co'>## of normal samples</span>
<span class='va'>segtable</span> <span class='op'>&lt;-</span> <span class='fu'><a href='CNpreprocessing.html'>CNpreprocessing</a></span><span class='op'>(</span>segall <span class='op'>=</span> <span class='va'>segexample</span><span class='op'>[</span><span class='va'>segexample</span><span class='op'>[</span>,<span class='st'>"ID"</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>"WZ2"</span>,<span class='op'>]</span>,
    ratall <span class='op'>=</span> <span class='va'>ratexample</span>, idCol <span class='op'>=</span> <span class='st'>"ID"</span>, startCol <span class='op'>=</span> <span class='st'>"start"</span>, endCol <span class='op'>=</span> <span class='st'>"end"</span>,
    chromCol <span class='op'>=</span> <span class='st'>"chrom"</span>, bpStartCol <span class='op'>=</span> <span class='st'>"chrom.pos.start"</span>, 
    bpEndCol <span class='op'>=</span> <span class='st'>"chrom.pos.end"</span>, blsize <span class='op'>=</span> <span class='fl'>50</span>, minJoin <span class='op'>=</span> <span class='fl'>0.25</span>, cWeight <span class='op'>=</span> <span class='fl'>0.4</span>,
    bsTimes <span class='op'>=</span> <span class='fl'>50</span>, chromRange <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>22</span>, nJobs <span class='op'>=</span> <span class='fl'>1</span>, 
    modelNames <span class='op'>=</span> <span class='st'>"E"</span>, normalLength <span class='op'>=</span> <span class='va'>normsegs</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, 
    normalMedian <span class='op'>=</span> <span class='va'>normsegs</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>

<span class='co'>## Add an eventIndex column to segtable that identifies the </span>
<span class='co'>## amplication (marked as 1) and deletion (marked as -1) events</span>
<span class='va'>eventIndex</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>segtable</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>eventIndex</span><span class='op'>[</span><span class='va'>segtable</span><span class='op'>[</span>,<span class='st'>"marginalprob"</span><span class='op'>]</span> <span class='op'>&lt;</span> <span class='fl'>1e-4</span> <span class='op'>&amp;</span> <span class='va'>segtable</span><span class='op'>[</span>,<span class='st'>"negtail"</span><span class='op'>]</span> <span class='op'>&gt;</span> <span class='fl'>0.999</span> <span class='op'>&amp;</span> 
    <span class='va'>segtable</span><span class='op'>[</span>,<span class='st'>"mediandev"</span><span class='op'>]</span> <span class='op'>&lt;</span> <span class='fl'>0</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>1</span>
<span class='va'>eventIndex</span><span class='op'>[</span><span class='va'>segtable</span><span class='op'>[</span>,<span class='st'>"marginalprob"</span><span class='op'>]</span> <span class='op'>&lt;</span> <span class='fl'>1e-4</span> <span class='op'>&amp;</span> <span class='va'>segtable</span><span class='op'>[</span>,<span class='st'>"negtail"</span><span class='op'>]</span> <span class='op'>&gt;</span> <span class='fl'>0.999</span> <span class='op'>&amp;</span>
    <span class='va'>segtable</span><span class='op'>[</span>,<span class='st'>"mediandev"</span><span class='op'>]</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>segtable</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>segtable</span>, <span class='va'>eventIndex</span><span class='op'>)</span>

<span class='co'>## Create a mask table using amplification and deletion regions as input</span>
<span class='va'>namps17</span> <span class='op'>&lt;-</span> <span class='va'>cnpexample</span><span class='op'>[</span><span class='va'>cnpexample</span><span class='op'>[</span>,<span class='st'>"copy.num"</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>"amp"</span>,<span class='op'>]</span>
<span class='va'>aCNPmask</span> <span class='op'>&lt;-</span> <span class='fu'><a href='makeCNPmask.html'>makeCNPmask</a></span><span class='op'>(</span>imat<span class='op'>=</span><span class='va'>namps17</span>, chromCol<span class='op'>=</span><span class='fl'>2</span>, startCol<span class='op'>=</span><span class='fl'>3</span>, 
    endCol<span class='op'>=</span><span class='fl'>4</span>, nProf<span class='op'>=</span><span class='fl'>1203</span>, uThresh<span class='op'>=</span><span class='fl'>0.02</span>, dThresh<span class='op'>=</span><span class='fl'>0.008</span><span class='op'>)</span>
<span class='va'>ndels17</span> <span class='op'>&lt;-</span> <span class='va'>cnpexample</span><span class='op'>[</span><span class='va'>cnpexample</span><span class='op'>[</span>,<span class='st'>"copy.num"</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>"del"</span>,<span class='op'>]</span>
<span class='va'>dCNPmask</span> <span class='op'>&lt;-</span> <span class='fu'><a href='makeCNPmask.html'>makeCNPmask</a></span><span class='op'>(</span>imat<span class='op'>=</span><span class='va'>ndels17</span>, chromCol<span class='op'>=</span><span class='fl'>2</span>, startCol<span class='op'>=</span><span class='fl'>3</span>, 
    endCol<span class='op'>=</span><span class='fl'>4</span>, nProf<span class='op'>=</span><span class='fl'>1203</span>, uThresh<span class='op'>=</span><span class='fl'>0.02</span>, dThresh<span class='op'>=</span><span class='fl'>0.008</span><span class='op'>)</span>
<span class='va'>maskTable</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>aCNPmask</span>, cnpindex<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>, 
    <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>dCNPmask</span>, cnpindex<span class='op'>=</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## Apply a mask to a table of copy number events</span>
<span class='va'>maskedCNP</span> <span class='op'>&lt;-</span> <span class='fu'><a href='applyCNPmask.html'>applyCNPmask</a></span><span class='op'>(</span>segTable<span class='op'>=</span><span class='va'>segtable</span>, chrom<span class='op'>=</span><span class='st'>"chrom"</span>,
    startPos<span class='op'>=</span><span class='st'>"chrom.pos.start"</span>, endPos<span class='op'>=</span><span class='st'>"chrom.pos.end"</span>, 
    startProbe<span class='op'>=</span><span class='st'>"start"</span>, endProbe<span class='op'>=</span><span class='st'>"end"</span>, eventIndex<span class='op'>=</span><span class='st'>"eventIndex"</span>,
    maskTable<span class='op'>=</span><span class='va'>maskTable</span>, maskChrom<span class='op'>=</span><span class='st'>"chrom"</span>, maskStart<span class='op'>=</span><span class='st'>"start"</span>, 
    maskEnd<span class='op'>=</span><span class='st'>"end"</span>, maskIndex<span class='op'>=</span><span class='st'>"cnpindex"</span>, minCover<span class='op'>=</span><span class='fl'>0.005</span>,
    indexVals<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## Show some results</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>maskedCNP</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        StartProbe EndProbe toremove
#&gt; [165,]      80389    81843        0
#&gt; [166,]      81844    81854        0
#&gt; [167,]      81855    81877        0
#&gt; [168,]      81878    82039        0
#&gt; [169,]      82040    82055        0
#&gt; [170,]      82056    83055        0</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alex Krasnitz, Pascal Belleau, Astrid Deschênes, Guoli Sun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


