<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate the median of the sampled copy number values from bins 
associated to selected segments. — segsample • CNprep</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Calculate the median of the sampled copy number values from bins 
associated to selected segments. — segsample" />
<meta property="og:description" content="This function calculates the median of the sampled copy number
values from bins associated to selected segments. The median of the samples
copy number values can be calculated multiple times for the same segments 
(sampling with replacement, bootstrap).
There is two way to select the number of times the median is calculated for
a segment. The first way is using a minimum number of bins per 
segments; the integer division of the current number of bins with the 
specified minimum number of bins gives the number of times the median is
calculated. The second way is to pass an integer that directly specifying 
the number of times the median is calculated for each segment." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CNprep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CNprep.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/KrasnitzLab/CNprep/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate the median of the sampled copy number values from bins 
associated to selected segments.</h1>
    <small class="dont-index">Source: <a href='https://github.com/KrasnitzLab/CNprep/blob/master/R/segsample.R'><code>R/segsample.R</code></a></small>
    <div class="hidden name"><code>segsample.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function calculates the median of the sampled copy number
values from bins associated to selected segments. The median of the samples
copy number values can be calculated multiple times for the same segments 
(sampling with replacement, bootstrap).
There is two way to select the number of times the median is calculated for
a segment. The first way is using a minimum number of bins per 
segments; the integer division of the current number of bins with the 
specified minimum number of bins gives the number of times the median is
calculated. The second way is to pass an integer that directly specifying 
the number of times the median is calculated for each segment.</p>
    </div>

    <pre class="usage"><span class='fu'>segsample</span><span class='op'>(</span>
  <span class='va'>mysegs</span>,
  <span class='va'>ratcol</span>,
  startcol <span class='op'>=</span> <span class='st'>"StartProbe"</span>,
  endcol <span class='op'>=</span> <span class='st'>"EndProbe"</span>,
  blocksize <span class='op'>=</span> <span class='fl'>0</span>,
  times <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mysegs</th>
      <td><p>a <code>data.frame</code> containing information about the 
segments in 5 columns:</p><ul>
<li><p><code>StartProbe</code> a <code>numeric</code> that tabulates the (integer) 
    start position of each segment in internal units such as probe numbers.</p></li>
<li><p><code>EndProbe</code> a <code>numeric</code> that tabulates the (integer) 
    end position of each segment in internal units such as probe numbers.</p></li>
<li><p><code>chrom</code> a <code>numeric</code> representing the chromosome.</p></li>
<li><p><code>segmedian</code> a <code>numeric</code> representing the median for the 
    group of bins associated to one segment</p></li>
<li><p><code>segmad</code> a <code>numeric</code> representing the median absolute 
    deviation for the group of bins associated to one segment</p></li>
</ul></td>
    </tr>
    <tr>
      <th>ratcol</th>
      <td><p>a <code>vector</code> containing the copy number values (usually in
log2) for each bin associated to a segment present in <code>mysegs</code>. The
length of the <code>vector</code> should correspond to the total number of bins
present in <code>mysegs</code>.</p></td>
    </tr>
    <tr>
      <th>startcol</th>
      <td><p>a <code>character</code> string specifying the name of column 
in <code>mysegs</code> that tabulates the (integer) start position of each segment 
in internal units such as probe numbers for data of CGH microarray origin.
Default: "StartProbe".</p></td>
    </tr>
    <tr>
      <th>endcol</th>
      <td><p>a <code>character</code> string specifying the name of column 
in <code>mysegs</code> that tabulates the (integer) end postion of each segment 
in internal units such as probe numbers for data of CGH microarray origin.
Default: "EndProbe".</p></td>
    </tr>
    <tr>
      <th>blocksize</th>
      <td><p>a <code>integer</code> specifying how many bins must be
present in a segment so that the segment is selected to be sampled. 
Either <code>blocksize</code> or <code>times</code> must be specified by user.
Default: <code>0</code>.</p></td>
    </tr>
    <tr>
      <th>times</th>
      <td><p>a <code>integer</code> specifying the number of times
each segment must be sampled. 
Either <code>blocksize</code> or <code>times</code> must be specified by user.
Default: <code>0</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code>data.frame</code> containing the information about the selected
segments and the median of the sampled copy number values with replacement 
from the associated bins. It contains 3 columns:</p><ul>
<li><p><code>StartProbe</code> a <code>numeric</code> that tabulates the (integer) 
    start position of each segment in internal units such as probe numbers.</p></li>
<li><p><code>EndProbe</code> a <code>numeric</code> that tabulates the (integer) 
    end position of each segment in internal units such as probe numbers.</p></li>
<li><p><code>NoName</code> a <code>numeric</code> representing the median value of the
sampled bins.</p></li>
</ul>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Alexander Krasnitz, Guoli Sun</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Create a data.frame with 3 segments on chromosome 1</span>
<span class='va'>segData</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>StartProbe<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>9</span>, <span class='fl'>13</span><span class='op'>)</span>, EndProbe<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>8</span>, <span class='fl'>12</span>, <span class='fl'>15</span><span class='op'>)</span>,
    chrom<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>, segmedian<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.06662475</span>, <span class='fl'>0.06719237</span>, <span class='fl'>0.07111544</span><span class='op'>)</span>,
    segmad<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.06213208</span>, <span class='fl'>0.04722233</span>, <span class='fl'>0.07633202</span><span class='op'>)</span><span class='op'>)</span>
    
<span class='co'>## Copy number ratio (in log2) for each bin </span>
<span class='co'>## Multiples bins are associated to 1 segment</span>
<span class='va'>ratcol</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.062073840</span>, <span class='fl'>0.10913919</span>,  <span class='fl'>0.143459489</span>,  <span class='fl'>0.033994620</span>, 
    <span class='op'>-</span><span class='fl'>0.072243732</span>, <span class='fl'>0.082252725</span>,  <span class='fl'>0.151908930</span>,  <span class='fl'>0.101589490</span>,  <span class='fl'>0.08554752</span>, 
    <span class='op'>-</span><span class='fl'>0.011155011</span>, <span class='op'>-</span><span class='fl'>0.122291649</span>, <span class='fl'>0.063634112</span>,  <span class='fl'>0.110149474</span>,  <span class='fl'>0.043328961</span>,  
    <span class='fl'>0.1632174529</span><span class='op'>)</span>
    
<span class='co'>## Use an integer division to determine the number of times each</span>
<span class='co'>## segment is sampled</span>
<span class='fu'>CNprep</span><span class='fu'>:::</span><span class='fu'>segsample</span><span class='op'>(</span>mysegs<span class='op'>=</span><span class='va'>segData</span>, ratcol<span class='op'>=</span><span class='va'>ratcol</span>, blocksize<span class='op'>=</span><span class='fl'>4</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     StartProbe EndProbe apply(segtable, 1, smedian.sample, v = ratcol)
#&gt; 1            1        8                                     0.09192111
#&gt; 1.1          1        8                                     0.09192111
#&gt; 2            9       12                                     0.02623955</div><div class='input'>
<span class='co'>## Each segment is sampled the same number of times</span>
<span class='fu'>CNprep</span><span class='fu'>:::</span><span class='fu'>segsample</span><span class='op'>(</span>mysegs<span class='op'>=</span><span class='va'>segData</span>, ratcol<span class='op'>=</span><span class='va'>ratcol</span>, times<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     StartProbe EndProbe apply(segtable, 1, smedian.sample, v = ratcol)
#&gt; 1            1        8                                     0.08225272
#&gt; 1.1          1        8                                     0.12629934
#&gt; 2            9       12                                     0.06363411
#&gt; 2.1          9       12                                     0.07459082
#&gt; 3           13       15                                     0.16321745
#&gt; 3.1         13       15                                     0.11014947</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alex Krasnitz, Pascal Belleau, Astrid Deschênes, Guoli Sun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


