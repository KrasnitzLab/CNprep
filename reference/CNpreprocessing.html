<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Pre-process DNA copy number (CN) data for detection of CN events. — CNpreprocessing • CNprep</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Pre-process DNA copy number (CN) data for detection of CN events. — CNpreprocessing" />
<meta property="og:description" content="The package evaluates DNA copy number data, using both their 
initial form (copy number as a noisy function of genomic position) and their
approximation by a piecewise-constant function (segmentation), for the 
purpose of identifying genomic regions where the copy number differs from 
the norm." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CNprep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CNprep.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/KrasnitzLab/CNprep/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pre-process DNA copy number (CN) data for detection of CN events.</h1>
    <small class="dont-index">Source: <a href='https://github.com/KrasnitzLab/CNprep/blob/master/R/CNpreprocessing.R'><code>R/CNpreprocessing.R</code></a></small>
    <div class="hidden name"><code>CNpreprocessing.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The package evaluates DNA copy number data, using both their 
initial form (copy number as a noisy function of genomic position) and their
approximation by a piecewise-constant function (segmentation), for the 
purpose of identifying genomic regions where the copy number differs from 
the norm.</p>
    </div>

    <pre class="usage"><span class='fu'>CNpreprocessing</span><span class='op'>(</span>
  <span class='va'>segall</span>,
  ratall <span class='op'>=</span> <span class='cn'>NULL</span>,
  idCol <span class='op'>=</span> <span class='cn'>NULL</span>,
  startCol <span class='op'>=</span> <span class='cn'>NULL</span>,
  endCol <span class='op'>=</span> <span class='cn'>NULL</span>,
  medCol <span class='op'>=</span> <span class='cn'>NULL</span>,
  madCol <span class='op'>=</span> <span class='cn'>NULL</span>,
  errorCol <span class='op'>=</span> <span class='cn'>NULL</span>,
  chromCol <span class='op'>=</span> <span class='cn'>NULL</span>,
  bpStartCol <span class='op'>=</span> <span class='cn'>NULL</span>,
  bpEndCol <span class='op'>=</span> <span class='cn'>NULL</span>,
  annot <span class='op'>=</span> <span class='cn'>NULL</span>,
  annotStartCol <span class='op'>=</span> <span class='cn'>NULL</span>,
  annotEndCol <span class='op'>=</span> <span class='cn'>NULL</span>,
  annotChromCol <span class='op'>=</span> <span class='cn'>NULL</span>,
  useEnd <span class='op'>=</span> <span class='cn'>FALSE</span>,
  blsize <span class='op'>=</span> <span class='cn'>NULL</span>,
  minJoin <span class='op'>=</span> <span class='cn'>NULL</span>,
  nTrial <span class='op'>=</span> <span class='fl'>10</span>,
  bestBIC <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1e+07</span>,
  modelNames <span class='op'>=</span> <span class='st'>"E"</span>,
  cWeight <span class='op'>=</span> <span class='cn'>NULL</span>,
  bsTimes <span class='op'>=</span> <span class='cn'>NULL</span>,
  chromRange <span class='op'>=</span> <span class='cn'>NULL</span>,
  nJobs <span class='op'>=</span> <span class='fl'>1</span>,
  normalLength <span class='op'>=</span> <span class='cn'>NULL</span>,
  normalMedian <span class='op'>=</span> <span class='cn'>NULL</span>,
  normalMad <span class='op'>=</span> <span class='cn'>NULL</span>,
  normalError <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>segall</th>
      <td><p>a <code>matrix</code> or a <code>data.frame</code> for segmented copy 
number profiles. It may have a character column, with a name specified 
by <code>idCol</code>, and/or numeric columns with names specified by 
<code>startCol, endCol, medCol, madCol,errorCol</code>  
<code>,chromCol, bpStartCol, bpEndCol</code>. Each row of <code>segall</code> 
corresponds to a segment belonging to one of the profiles 
to be pre-processed.</p></td>
    </tr>
    <tr>
      <th>ratall</th>
      <td><p>a <code>matrix</code> whose rows correspond to genomic positions 
and columns to copy number profiles. The elements of this matrix are 
functions of copy number, most often log ratios of copy number to 
the expected standard value, such as 2 in diploid genomes.</p></td>
    </tr>
    <tr>
      <th>idCol</th>
      <td><p>a <code>character</code> string specifying the name for the 
column in <code>segall</code> tabulating the profile IDs. When not specified,
the numerical column of the <code>ratall</code> object will be used as the
profile IDs. Default: <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>startCol</th>
      <td><p>a <code>character</code> string specifying the name of column 
in <code>segall</code> that tabulates the (integer) start position of each segment 
in internal units such as probe numbers for data of CGH microarray origin.
Default: <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>endCol</th>
      <td><p>a <code>character</code> string specifying the name of column 
in <code>segall</code> that tabulates the (integer) end position of each segment 
in internal units such as probe numbers for data of CGH microarray origin.
Default: <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>medCol</th>
      <td><p>a <code>character</code> string specifying the 
name of column in <code>segall</code> that, for the function of copy number used 
in the study (typically log ratios), tabulates the (numeric) values for 
the function (<code>medCol</code>), a measure of its spread (<code>madCol</code>) and 
its error (<code>errorCol</code>) for the segment. Default: <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>madCol</th>
      <td><p>a <code>character</code> string specifying the 
name of column in <code>segall</code> that, for the function of copy number used 
in the study (typically log ratios), tabulates the (numeric) values for 
a measure of spread (<code>madCol</code>) related to  
the function (<code>medCol</code>) for the segment. Default: <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>errorCol</th>
      <td><p>a <code>character</code> string specifying the 
name of column in <code>segall</code> that, for the function of copy number used 
in the study (typically log ratios), tabulates the (numeric) values for 
the error (<code>errorCol</code>) related to  
the function (<code>medCol</code>) for the segment. Default: <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>chromCol</th>
      <td><p>a <code>character</code> string specifying the name for the 
column in <code>segall</code> tabulating the (integer) chromosome number for 
each segment.</p></td>
    </tr>
    <tr>
      <th>bpStartCol</th>
      <td><p>a <code>character</code> string specifying the name of 
column in <code>segall</code> that tabulates the (integer) genomic start 
coordinate of each segment.</p></td>
    </tr>
    <tr>
      <th>bpEndCol</th>
      <td><p>a <code>character</code> string specifying the name of 
column in <code>segall</code> that tabulates the (integer) genomic end 
coordinate of each segment.</p></td>
    </tr>
    <tr>
      <th>annot</th>
      <td><p>a <code>matrix</code> or a <code>data.frame</code> that contains the 
annotation for the copy number measurement platform in the study. It is 
generally expected to contain columns with names specified by 
<code>annotStartCol, annotEndCol, annotChromCol</code>.</p></td>
    </tr>
    <tr>
      <th>annotStartCol</th>
      <td><p>a <code>character</code> string 
specifying the name of column in <code>annot</code> that tabulates the (integer) 
genomic start coordinates in case of CGH microarrays.</p></td>
    </tr>
    <tr>
      <th>annotEndCol</th>
      <td><p>a <code>character</code> string 
specifying the name of column in <code>annot</code> that tabulates the (integer) 
genomic end coordinates in case of CGH microarrays.</p></td>
    </tr>
    <tr>
      <th>annotChromCol</th>
      <td><p>a <code>character</code> string 
specifying the name of column in <code>annot</code> that tabulates the chromosome
number for each copy number measuring unit, such as a probe in case of CGH
microarrays.</p></td>
    </tr>
    <tr>
      <th>useEnd</th>
      <td><p>a single logical value specifying whether the segment end 
positions as given by the <code>bpEndCol</code> of <code>segall</code> are to be 
looked up in the <code>annotEndCol</code> column of <code>annot</code> 
(if <code>useEnd=TRUE</code>) or in the <code>annotStartCol</code> column (default). 
Default: <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>blsize</th>
      <td><p>a single <code>integer</code> specifying the bootstrap sampling 
rate of segment medians to generate input for model-based clustering. The 
number of times a segment is sampled is then given by the (integer) 
division of the segment length in internal units by <code>blsize</code>.</p></td>
    </tr>
    <tr>
      <th>minJoin</th>
      <td><p>a single <code>numeric</code> value between 0 and 1 specifying the 
degree of overlap above which two clusters will be joined into one. Default:
<code>NULL</code>. TODO= HAVE a default value, not NULL.</p></td>
    </tr>
    <tr>
      <th>nTrial</th>
      <td><p>a single positive <code>integer</code> specifying the number of 
times a model-based 
clustering is attempted for each profile in order to achieve the 
highest Bayesian information criterion (BIC). Default: <code>10</code>.</p></td>
    </tr>
    <tr>
      <th>bestBIC</th>
      <td><p>a single <code>numeric</code> value for initalizing the
Bayesian information criterion (BIC) 
maximization. A large negative value is recommended. Default: <code>-1e7</code>.</p></td>
    </tr>
    <tr>
      <th>modelNames</th>
      <td><p>a <code>vector</code> of <code>character</code> strings specifying 
the names of models to be used in model-based clustering (see package 
<code>mclust</code> for further details). The default is <code>"E"</code>.</p></td>
    </tr>
    <tr>
      <th>cWeight</th>
      <td><p>A single <code>numeric</code> value between <code>0</code> and <code>1</code> 
specifying the minimal share of the central cluster in each profile.</p></td>
    </tr>
    <tr>
      <th>bsTimes</th>
      <td><p>a single positive <code>double</code> value specifying the number 
of time the median of each segment is sampled in order to predict the 
cluster assignment for the segment. Default: <code>NULL</code>. TODO: select a 
default value that is not null.</p></td>
    </tr>
    <tr>
      <th>chromRange</th>
      <td><p>a <code>integer</code> <code>vector</code> enumerating chromosomes 
from which segments are to be used for initial model-based clustering.
Default: <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>nJobs</th>
      <td><p>a single positive <code>integer</code> specifying the number of 
worker jobs to create in case of distributed computation. 
Default: <code>1</code> and always <code>1</code> for Windows.</p></td>
    </tr>
    <tr>
      <th>normalLength</th>
      <td><p>an integer <code>vector</code> specifying the genomic lengths 
of segments in the normal reference data. Default: <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>normalMedian</th>
      <td><p>a numeric <code>vector</code>, 
of the same length as <code>normalLength</code>, specifying the segment values
of the normal reference segments. Default: <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>normalMad</th>
      <td><p>a numeric <code>vector</code>, 
of the same length as <code>normalLength</code>, specifying the value spreads 
of the normal reference segments. Default: <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>normalError</th>
      <td><p>a numeric <code>vector</code>, 
of the same length as <code>normalLength</code>, specifying the error values
of the normal reference segments. Default: <code>NULL</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The input <code>segall</code> <code>data.frame</code> to which some or all of 
the following columns may be bound, depending on the availability of input:</p><ul>
<li><p>segmedian a <code>numeric</code>, the median function of copy number</p></li>
<li><p>segmad a <code>numeric</code>, the MAD for the function of copy number</p></li>
<li><p>mediandev a <code>numeric</code>, the median function of copy number 
relative to its central value</p></li>
<li><p>segerr a <code>numeric</code>, the error estimate for the 
function of copy number</p></li>
<li><p>centerz a <code>numeric</code> between <code>0</code> and <code>1</code>, the 
probability that the segment is in the central cluster</p></li>
<li><p>marginalprob a <code>numeric</code>, the marginal probability for 
the segment in the central cluster</p></li>
<li><p>maxz TODO</p></li>
<li><p>maxzmean TODO</p></li>
<li><p>maxzsigma TODO</p></li>
<li><p>samplesize TODO</p></li>
<li><p>negtail the probability of finding the deviation as observed or 
larger in a collection of central segments</p></li>
<li><p>negtailnormad the probability of finding the deviation/MAD as 
observed or larger in a collection of central segments</p></li>
<li><p>negtailnormerror a <code>numeric</code>, the probability of finding 
the deviation/error as observed or larger in a collection of 
central segments</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Depending on the availability of input, the function will 
perform the following operations for each copy number profile.</p>
<p>If raw data are available in addition to segment start and end positions,
median and MAD of each segment will be computed. For each profile, bootstrap 
sampling of the segment median values will be performed, and the sample will 
be used to estimate the error in the median for each segment. 
Model-dependent clustering (fitting to a gaussian mixture) of the sample 
will be performed. The central cluster (the one nearest the expected 
unaltered value) will be identified and, if necessary, merged with adjacent 
clusters in order to comprise the minimal required fraction of the data. 
Deviation of each segment from the center, its probability to belong to the 
central cluster and its marginal probability in the central cluster will be 
computed.</p>
<p>If segment medians or median deviations are available or have been computed, 
and, in addition, genomic lengths and average values are given for a 
collection of segments with unaltered copy number, additional estimates will 
be performed. If median values are available for the unaltered segments, the
marginal probability of the observed median or median deviation in the 
unaltered set will be computed for each segment. Likewise, marginal 
probabilities for median/MAD and/or median/error will be computed if these 
statistics are available.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Alexander Krasnitz</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alex Krasnitz, Pascal Belleau, Astrid Deschênes, Guoli Sun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


